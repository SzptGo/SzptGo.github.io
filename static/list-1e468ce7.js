import{aa as e,b as a,a as l,r,n as t,h as o,Y as d,j as i,w as p,i as u,f as n,aj as s,o as c,y as m,C as g,l as f,ag as b,am as v,t as h,q as y,D as _,F as w,p as I,E as V,ae as x,_ as q}from"./index-51cf8a1b.js";import{g as C}from"./brand-f48cc1ef.js";import{g as T}from"./country-2f98978e.js";import{g as k}from"./power-type-85c9c42a.js";import{g as P}from"./car-type-fe5ba8b8.js";import{u as N}from"./usePagination-905dfb5f.js";import{f as z,p as U}from"./image-c643a496.js";const j={age:void 0,brand:"",carBrand:{brandId:"",brandName:"",brandCountryId:""},carImage:"",carPowerType:{powerTypeId:"",powerTypeName:""},carType:{typeId:"",typeName:""},carTypeId:"",color:"",deposit:void 0,description:"",displacement:void 0,driver:void 0,km:void 0,ownerId:"",origionalPrice:void 0,postId:"",postName:"",powerTypeId:"",price:void 0,region:"",seat:void 0,status:0,tradeCount:void 0,user:{id:"",name:"",avatar:"",token:"",phone:"",level:0,createDate:"",updateDate:"",roleId:"",addrId:""}},L={class:"app-container"},D={class:"toolbar-wrapper"},S={class:"table-wrapper"},B={class:"pager-wrapper"},$={class:"card-container"},E=a({name:"ElementPlus"}),M=q(a({...E,setup(a){const q=l(!1),E=r("http://110.41.150.2/api/upload"),M=r("http://110.41.150.2:32976/image"),{paginationData:O,handleCurrentChange:A,handleSizeChange:F}=N(),K=l([]);C().then((e=>K.value=e.data));const R=l([]);k().then((e=>R.value=e.data));const Y=l([]);P().then((e=>Y.value=e.data));const G=["image/jpeg","image/png","image/jpg","image/gif"],H=l([]),J=e=>{const{type:a,size:l}=e;return G.includes(a)?!(l>2097152)||(V.error("图片必须小于2MB"),!1):(V.error("图片格式不支持！"),!1)},Q=l(!1),W=l(null),X=r(j),Z=r({postName:[{required:!0,message:"请填写车型名称",trigger:"blur"}],origionalPrice:[{required:!0,message:"请填写车原价",trigger:"blur"}],price:[{required:!0,message:"请填写出价",trigger:"blur"}],deposit:[{required:!0,message:"请填写定金",trigger:"blur"}],brand:[{required:!0,message:"请选择汽车品牌",trigger:"change"}],carTypeId:[{required:!0,message:"请选择车型",trigger:"change"}],powerTypeId:[{required:!0,message:"请选择能源类型",trigger:"change"}],color:[{required:!0,message:"请填写车颜色",trigger:"blur"}],age:[{required:!0,message:"请填写车龄",trigger:"blur"}],km:[{required:!0,message:"请填写里程数",trigger:"blur"}],displacement:[{required:!0,message:"请填写排量",trigger:"blur"}],seat:[{required:!0,message:"请填写座位数",trigger:"blur"}],region:[{required:!0,message:"请填写上牌地区",trigger:"blur"}],driver:[{required:!0,message:"请填写驱动类型",trigger:"blur"}],tradeCount:[{required:!0,message:"请填写过户次数",trigger:"blur"}]}),ee=()=>{var a;null==(a=W.value)||a.validate((a=>{if(!a)return!1;var l;X.carImage=z(H.value),X.postId?function(a){return e({url:`TbCarPost/${a.postId}`,method:"put",data:a})}(X).then((e=>{e.data?(oe(),ae(),Q.value=!1,V.success("修改成功")):V.error("修改失败")})):(l=X,e({url:"TbCarPost",method:"post",data:l})).then((e=>{e.data?(oe(),ae(),Q.value=!1,V.success("新增成功")):V.error("新增失败")}))}))},ae=()=>{Object.assign(X,{age:void 0,brand:"",carBrand:{brandId:"",brandName:"",brandCountryId:""},carImage:"",carPowerType:{powerTypeId:"",powerTypeName:""},carType:{typeId:"",typeName:""},carTypeId:"",color:"",deposit:void 0,description:"",displacement:void 0,driver:void 0,km:void 0,ownerId:"",origionalPrice:void 0,postId:"",postName:"",powerTypeId:"",price:void 0,region:"",seat:void 0,status:0,tradeCount:void 0,user:{id:"",name:"",avatar:"",token:"",phone:"",level:0,createDate:"",updateDate:"",roleId:"",addrId:""}}),H.value=[]},le=a=>{a.postId?x.confirm(`您确定删除【${a.postName}】吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{var l;(l=a.postId,e({url:`TbCarPost/${l}`,method:"delete"})).then((e=>{e.data?(V.success("删除成功"),oe()):V.error("删除失败")}))})):V.error("无法删除该二手车！")},re=l([]),te=l([]);T().then((e=>te.value=e.data));const oe=async()=>{q.value=!0;try{const a=await function(a=1,l=9999){return e({url:`/TbCarPost/getListAdmin/${a}/${l}`,method:"get"})}(O.currentPage,O.pageSize);re.value=a.data.records,O.total=a.data.total,re.value.forEach((e=>{e.srcList=e.carImage.split(",");for(let a=0;a<e.srcList.length;a++)e.srcList[a]=M+e.srcList[a]}))}catch(a){console.error(a),re.value=[]}finally{q.value=!1}};return oe(),t([()=>O.currentPage,()=>O.pageSize],oe,{immediate:!0}),(e,a)=>{const l=n("el-button"),r=n("el-tooltip"),t=n("el-table-column"),V=n("el-image"),x=n("el-table"),C=n("el-pagination"),T=n("el-card"),k=n("el-text"),P=n("el-form-item"),N=n("el-input"),z=n("el-col"),j=n("el-row"),M=n("el-option"),G=n("el-select"),te=n("Plus"),de=n("el-icon"),ie=n("el-upload"),pe=n("el-scrollbar"),ue=n("el-form"),ne=n("el-dialog"),se=s("loading");return c(),o("div",L,[d((c(),i(T,{shadow:"never"},{default:p((()=>[m("div",D,[m("div",null,[u(l,{type:"primary",icon:f(b),onClick:a[0]||(a[0]=e=>Q.value=!0)},{default:p((()=>[g("发布二手车")])),_:1},8,["icon"])]),m("div",null,[u(r,{content:"刷新表格"},{default:p((()=>[u(l,{type:"primary",icon:f(v),circle:"",onClick:oe},null,8,["icon"])])),_:1})])]),m("div",S,[u(x,{data:re.value,style:{width:"100%"},"row-key":"id",border:""},{default:p((()=>[u(t,{prop:"postId",label:"发布 ID",align:"center"}),u(t,{prop:"postName",label:"发布标题","min-width":"170px"}),u(t,{label:"金额","min-width":"150px"},{default:p((e=>[m("div",null,"车原价：￥"+h(e.row.origionalPrice),1),m("div",null,"价格：￥"+h(e.row.price),1),m("div",null,"定金：￥"+h(e.row.deposit),1)])),_:1}),u(t,{prop:"postName",label:"图片","min-width":"160px",align:"center"},{default:p((e=>[u(V,{style:{width:"100px",height:"100px"},src:e.row.srcList[0],"zoom-rate":1.2,"preview-src-list":e.row.srcList,"initial-index":4,fit:"cover","preview-teleported":!0},null,8,["src","zoom-rate","preview-src-list"]),m("div",null,"共"+h(e.row.srcList.length)+"张(点击图片查看)",1)])),_:1}),u(t,{prop:"color",label:"颜色","min-width":"60px",align:"center"}),u(t,{prop:"age",label:"车龄","min-width":"60px",align:"center"}),u(t,{prop:"km",label:"里程数/km","min-width":"95px",align:"center"}),u(t,{prop:"displacement",label:"排量(L)","min-width":"70px",align:"center"}),u(t,{prop:"seat",label:"座位数","min-width":"70px",align:"center"}),u(t,{prop:"region",label:"上牌地区","min-width":"85px",align:"center"}),u(t,{prop:"driver",label:"驱动","min-width":"60px",align:"center"}),u(t,{prop:"tradeCount",label:"过户记录",align:"center","min-width":"90px"}),u(t,{prop:"createDate",label:"发布时间",align:"center","min-width":"155px"}),u(t,{fixed:"right",label:"操作","min-width":"170",align:"center"},{default:p((e=>[u(l,{type:"primary",text:"",bg:"",size:"small",icon:"Edit",onClick:a=>{return l=e.row,Object.assign(X,l),H.value=U(l.carImage),void(Q.value=!0);var l}},{default:p((()=>[g("修改")])),_:2},1032,["onClick"]),u(l,{type:"danger",text:"",bg:"",size:"small",icon:"Delete",onClick:a=>le(e.row)},{default:p((()=>[g("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),m("div",B,[u(C,{background:"",layout:f(O).layout,"page-sizes":f(O).pageSizes,total:f(O).total,"page-size":f(O).pageSize,currentPage:f(O).currentPage,onSizeChange:f(F),onCurrentChange:f(A)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[se,q.value]]),u(ne,{modelValue:Q.value,"onUpdate:modelValue":a[19]||(a[19]=e=>Q.value=e),title:X.postId?"修改二手车":"发布二手车",onClose:ae,width:"900px"},{footer:p((()=>[u(l,{onClick:a[18]||(a[18]=e=>Q.value=!1)},{default:p((()=>[g("取消")])),_:1}),u(l,{type:"primary",onClick:ee},{default:p((()=>[g("发布")])),_:1})])),default:p((()=>[u(ue,{model:X,ref_key:"formRef",ref:W,rules:Z,"label-position":"left","label-width":"80px",size:"default",onSubmit:a[17]||(a[17]=y((()=>{}),["prevent"]))},{default:p((()=>[u(pe,{height:"500px"},{default:p((()=>[m("div",$,[X.postId?(c(),i(P,{key:0,label:"二手车 ID","label-width":"100px"},{default:p((()=>[u(k,null,{default:p((()=>[g(h(X.postId),1)])),_:1})])),_:1})):_("",!0),u(P,{label:"车型",prop:"postName",class:"required"},{default:p((()=>[u(N,{modelValue:X.postName,"onUpdate:modelValue":a[1]||(a[1]=e=>X.postName=e),type:"text",clearable:"",placeholder:"请输入二手车型号（如：宝马i4 2022款 eDrive40）"},null,8,["modelValue"])])),_:1}),u(j,null,{default:p((()=>[u(z,{span:8},{default:p((()=>[u(P,{label:"购入原价",prop:"origionalPrice",class:"required"},{default:p((()=>[u(N,{step:"500",modelValue:X.origionalPrice,"onUpdate:modelValue":a[2]||(a[2]=e=>X.origionalPrice=e),type:"number",placeholder:"请输入车原价",min:"0"},{suffix:p((()=>[g(" 元 ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"售出定金",prop:"deposit",class:"required"},{default:p((()=>[u(N,{step:"500",modelValue:X.deposit,"onUpdate:modelValue":a[3]||(a[3]=e=>X.deposit=e),type:"number",placeholder:"请输入定金",min:"0"},{suffix:p((()=>[g(" 元 ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"售出价格",prop:"price",class:"required"},{default:p((()=>[u(N,{step:"500",modelValue:X.price,"onUpdate:modelValue":a[4]||(a[4]=e=>X.price=e),type:"number",placeholder:"请输入出价",min:"0"},{suffix:p((()=>[g(" 元 ")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(j,null,{default:p((()=>[u(z,{span:8},{default:p((()=>[u(P,{label:"汽车品牌",prop:"brand",class:"required"},{default:p((()=>[u(G,{modelValue:X.brand,"onUpdate:modelValue":a[5]||(a[5]=e=>X.brand=e),class:"full-width-input",clearable:"",placeholder:"请选择汽车品牌"},{default:p((()=>[(c(!0),o(w,null,I(K.value,(e=>(c(),i(M,{key:e.brandId,label:e.brandName,value:e.brandId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"车型",prop:"carTypeId",class:"required"},{default:p((()=>[u(G,{modelValue:X.carTypeId,"onUpdate:modelValue":a[6]||(a[6]=e=>X.carTypeId=e),class:"full-width-input",clearable:"",placeholder:"请选择车型"},{default:p((()=>[(c(!0),o(w,null,I(Y.value,(e=>(c(),i(M,{key:e.typeId,label:e.typeName,value:e.typeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"能源类型",prop:"powerTypeId",class:"required"},{default:p((()=>[u(G,{modelValue:X.powerTypeId,"onUpdate:modelValue":a[7]||(a[7]=e=>X.powerTypeId=e),class:"full-width-input",clearable:"",placeholder:"请选择能源类型"},{default:p((()=>[(c(!0),o(w,null,I(R.value,(e=>(c(),i(M,{key:e.powerTypeId,label:e.powerTypeName,value:e.powerTypeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(j,null,{default:p((()=>[u(z,{span:8},{default:p((()=>[u(P,{label:"车颜色",prop:"color",class:"required"},{default:p((()=>[u(N,{modelValue:X.color,"onUpdate:modelValue":a[8]||(a[8]=e=>X.color=e),type:"text",placeholder:"请输入车的颜色(如：黑色)"},null,8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"车龄",prop:"age",class:"required"},{default:p((()=>[u(N,{step:"0.1",modelValue:X.age,"onUpdate:modelValue":a[9]||(a[9]=e=>X.age=e),type:"number",placeholder:"请输入车龄",min:"0"},{suffix:p((()=>[g(" 年 ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"里程数",prop:"km",class:"required"},{default:p((()=>[u(N,{step:"500",modelValue:X.km,"onUpdate:modelValue":a[10]||(a[10]=e=>X.km=e),type:"number",placeholder:"请输入车的里程数",min:"0"},{suffix:p((()=>[g(" KM ")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(j,null,{default:p((()=>[u(z,{span:8},{default:p((()=>[u(P,{label:"排量(L)",prop:"displacement",class:"required"},{default:p((()=>[u(N,{step:"0.1",modelValue:X.displacement,"onUpdate:modelValue":a[11]||(a[11]=e=>X.displacement=e),type:"number",placeholder:"请输入排量(L)",min:"0"},{suffix:p((()=>[g(" L ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"座位数",prop:"seat",class:"required"},{default:p((()=>[u(N,{modelValue:X.seat,"onUpdate:modelValue":a[12]||(a[12]=e=>X.seat=e),type:"number",placeholder:"请输入座位数",min:"0"},{suffix:p((()=>[g(" 个 ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"上牌地区",prop:"region",class:"required"},{default:p((()=>[u(N,{modelValue:X.region,"onUpdate:modelValue":a[13]||(a[13]=e=>X.region=e),type:"text",placeholder:"请输入上牌地区"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(j,null,{default:p((()=>[u(z,{span:8},{default:p((()=>[u(P,{label:"驱动",prop:"driver",class:"required"},{default:p((()=>[u(N,{modelValue:X.driver,"onUpdate:modelValue":a[14]||(a[14]=e=>X.driver=e),type:"number",placeholder:"请输入驱动",min:"0"},{suffix:p((()=>[g(" 驱 ")])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(z,{span:7,offset:1},{default:p((()=>[u(P,{label:"过户记录",prop:"tradeCount",class:"required"},{default:p((()=>[u(N,{modelValue:X.tradeCount,"onUpdate:modelValue":a[15]||(a[15]=e=>X.tradeCount=e),type:"number",placeholder:"请输入过户记录",min:"0"},{suffix:p((()=>[g(" 次 ")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(P,{label:"图片"},{default:p((()=>[u(ie,{action:E,"file-list":H.value,"onUpdate:fileList":a[16]||(a[16]=e=>H.value=e),"before-upload":J,"list-type":"picture-card","show-file-list":"",limit:9},{default:p((()=>[u(de,null,{default:p((()=>[u(te)])),_:1})])),_:1},8,["action","file-list"])])),_:1})])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-1874fe9c"]]);export{M as default};
